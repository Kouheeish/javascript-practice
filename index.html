<!DOCTYPE html>
<html lang="ja" dir="ltr">
<head>
  <link rel="stylesheet" href="index.css" type = "text/css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

  <meta charset="utf-8">
  <title></title>
</head>
<body>
  <table class="A" width="300" height="300">
    <tr>
      <td id ="row1-col1" ></td>
      <td id ="row1-col2" ></td>
      <td id ="row1-col3" ></td>
    </tr>
    <tr>
      <td id ="row2-col1" ></td>
      <td id ="row2-col2" ></td>
      <td id ="row2-col3" ></td>
    </tr>
    <tr>
      <td id ="row3-col1" ></td>
      <td id ="row3-col2" ></td>
      <td id ="row3-col3"></td>
    </tr>
    <style>
    table {
      border-collapse: collapse;
    }
    td {
      border: solid 1px;
      padding: 0.5em;
    }
    </style>

  </table>

  <!-- <table>
  <tr>
  <th></th>
  <th class = "first_content">黄色</th>
  <th class = "secound_content" >青</th>
</tr>
<tr>
<td>数</td>
<td  class = "first_content">10</td>
<td class = "secound_content">5</td>
</tr>
</table>
<form class="form" action="index.html" method="get">
<div>
<input class ="inp" type ="text" name = "hoge"/>
</div>
<div class="">
<input class ="exp" type="text" name="hoge" disabled/>
</div>
<button class ="button" type="submit">GO</button>
</form>
<input type="text" id="datepicker"> -->
<script>
// N目並べのNの設定
const row_num = 3;
let mark = "〇";

$("table td").on("click",function(){
  if ($(this).text() != ""){
    return;}
    $(this).text(mark);
    if(mark =="〇"){
      mark = "×"
    }else{
      mark = "〇"
    }
  })

$('table td').on("click",function(){
  if(checkWin()){
    if(mark == "〇"){
      mark = "×"
    }else{
      mark = "〇"
    }
    alert( mark + "が勝ちました")
  }else if(checkDraw()){
    alert("引き分けです")
  }}
)


// 勝ち筋に沿って勝敗が着いたかどうか判定する
const checkWin = () => {
  let check_mark = '';
  let check_count = 0

  // 同じ行のチェック
  for (let row_no = 1; row_no <= row_num; row_no++) {
    check_count = 0
    for (let col_no = 1; col_no <= row_num; col_no++) {
      target_mark = $('#row' + row_no + '-col' + col_no).text();
      // 空だったらこの行のチェックは終わり
      if (target_mark == '') {
        break;
      }
      if (col_no == 1) {
        check_mark = target_mark;
      }
      if (target_mark == check_mark) {
        check_count++;
      } else {
        // 一回でも違うマークだったら行のチェックは終了
        break;
      }
    }
    if (check_count == row_num) {
      return true;
    }
  }

  // 同じ列のチェック
  for (let col_no = 1; col_no <= row_num; col_no++) {
    check_count = 0
    for (let row_no = 1; row_no <= row_num; row_no++) {
      target_mark = $('#row' + row_no + '-col' + col_no).text();
      // 空だったらこの列のチェックは終わり
      if (target_mark == '') {
        break;
      }
      if (row_no == 1) {
        check_mark = target_mark;
      }
      if (target_mark == check_mark) {
        check_count++;
      } else {
        // 一回でも違うマークだったら列のチェックは終了
        break;
      }
    }
    if (check_count == row_num) {
      return true;
    }
  }

  // 左上→右下への斜めのチェック
  check_count = 0
  for (let no = 1; no <= row_num; no++) {
    target_mark = $('#row' + no + '-col' + no).text();
    // 空だったらチェックは終わり
    if (target_mark == '') {
      break;
    }
    if (no == 1) {
      check_mark = target_mark;
    }
    if (target_mark == check_mark) {
      check_count++;
    } else {
      // 一回でも違うマークだったら列のチェックは終了
      break;
    }
  }
  if (check_count == row_num) {
    return true;
  }

  // 左下→右上への斜め
  check_count = 0
  for (let row_no = row_num; row_no >= 1; row_no--) {
    col_no = row_num - row_no +1;
    target_mark = $('#row' + row_no + '-col' + col_no).text();
    // 空だったらチェックは終わり
    if (target_mark == '') {
      break;
    }
    if (row_no == row_num) {
      check_mark = target_mark;
    }
    if (target_mark == check_mark) {
      check_count++;
    } else {
      // 一回でも違うマークだったら列のチェックは終了
      break;
    }
  }
  if (check_count == row_num) {
    return true;
  }

  return false;
}

// 引き分けかどうか判定する
const checkDraw = () => {
  let count = 0;
  // 同じ行のチェック
  for (let row_no = 1; row_no <= row_num; row_no++) {
    for (let col_no = 1; col_no <= row_num; col_no++) {
      target_mark = $('#row' + row_no + '-col' + col_no).text();
      // 空だったらは終わり
      if (target_mark == '') {
        break;
      }
      count++;
    }
    if (count == row_num ** 2) {
      return true;
    }
    return false;
  }
}

  //let inp = $(".inp")
  //let exp =$(".exp")
  //let but =$(".button")
  //but.on("click",function(){
  //if(!confirm('まじ？')){
  /* キャンセルの時の処理 */
  //return false;
  //}else{
  /*　OKの時の処理 */
  //location.href = 'index.html';
  //}
  //});

  //$('#datepicker').datepicker();

  //let inp = $(".inp")
  //let exp =$(".exp")
  //inp
  //("keyup",function(){
  //    txt = $(this).val();
  //    exp.val(txt);
  //})


  //d = document.getElementsByClassName('first_content');
  //for(i = 0; i < d.length; i++){
  //alert(d[i].innerText);
  //d[i].innerText = i;
  //}
  //elms = $(".secound_content")
  //elms.on("click",function(){
  //$(this).text("clicked");
  //});


  //alert(elms.text())


  </script>
</body>
</html>
